<script>
const sheetURL =
  "https://docs.google.com/spreadsheets/d/1OYhiZu4bU78u5CtmOkgMgp05vxZig2rdCcreBv0Pr3M/gviz/tq?tqx=out:json";

let odaiList = [];

fetch(sheetURL)
  .then(res => res.text())
  .then(text => {
    const jsonText = text.match(/google.visualization.Query.setResponse\\((.*)\\);/s)[1];
    const json = JSON.parse(jsonText);

    // B列（1）、3行目以降
    odaiList = json.table.rows
      .slice(2)
      .map(r => r.c[1]?.v)
      .filter(v => v);
  })
  .catch(e => {
    document.getElementById("odai").textContent = "読み込み失敗";
    console.error(e);
  });

function showOdai() {
  if (odaiList.length === 0) {
    document.getElementById("odai").textContent = "読み込み中…";
    return;
  }
  const r = Math.floor(Math.random() * odaiList.length);
  document.getElementById("odai").textContent = odaiList[r];
}
</script>
