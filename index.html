<script>
const sheetURL =
  "https://docs.google.com/spreadsheets/d/1OYhiZu4bU78u5CtmOkgMgp05vxZig2rdCcreBv0Pr3M/edit?usp=sharing";

let odaiList = [];

fetch(sheetURL)
  .then(res => res.text())
  .then(text => {
    const json = JSON.parse(text.substring(47).slice(0, -2));

    // B列（index 1）、3行目以降（index 2〜）
    odaiList = json.table.rows
      .slice(2) // ← 3行目から
      .map(r => r.c[1]?.v) // ← B列
      .filter(v => v);
  });

function showOdai() {
  if (odaiList.length === 0) {
    document.getElementById("odai").textContent = "読み込み中…";
    return;
  }
  const r = Math.floor(Math.random() * odaiList.length);
  document.getElementById("odai").textContent = odaiList[r];
}
</script>
